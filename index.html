<!DOCTYPE html>
<html>
	<head>
		<title>查詢香港警察長期服務獎章得獎者</title>
		<meta charset="utf-8">
		<meta name="description" content="以警員編號查詢警察姓名">
		<meta name="keywords" content="香港,警察,編號,查詢,表揚,香港警察,警察編號,查詢香港警察,表揚香港警察">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

		<script src="https://code.jquery.com/jquery-1.12.3.min.js"></script>
		
		<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
		<script src="https://code.getmdl.io/1.1.3/material.min.js"></script>
		
		<style>
			@import url(http://fonts.googleapis.com/earlyaccess/notosanstc.css);

			.mdl-button,
			.mdl-textfield,
			.mdl-data-table__cell--non-numeric {
				font-family: 'Noto Sans TC', sans-serif !important;
			}
			
			.container {
				text-align: center !important;
			}
			.section {
				display: inline-block !important;
			}
			.mdl-card {
				min-height: initial !important;
				width: 320px !important;
			}
			.mdl-card__actions {
				padding: 10px 20px !important;
			}
			.mdl-data-table {
				border: none !important;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="section">
				<div class="mdl-card mdl-shadow--2dp">
					<div class="mdl-card__supporting-text">
						<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<input class="mdl-textfield__input" type="text" pattern="-?[0-9]*(\.[0-9]+)?" id="no">
							<label class="mdl-textfield__label" for="no">警員編號</label>
							<span class="mdl-textfield__error">請輸入警員編號</span>
						</div>
						<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" onclick="search()">
							查詢<i class="material-icons">search</i>
						</button>
						<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" onclick="reset()">
							重設<i class="material-icons">cached</i>
						</button>
					</div>
				</div>
				<table class="mdl-data-table mdl-js-data-table" id="result-table">
					<thead>
						<tr>
							<th class="mdl-data-table__cell--non-numeric">警員編號</th>
							<th class="mdl-data-table__cell--non-numeric">警員姓名</th>
							<th class="mdl-data-table__cell--non-numeric">職級</th>
							<th class="mdl-data-table__cell--non-numeric">輔警?</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
			</div>
		</div>
		<div id="snackbar" class="mdl-js-snackbar mdl-snackbar">
			<div class="mdl-snackbar__text"></div>
			<button class="mdl-snackbar__action" type="button"></button>
		</div>
		
		<script>
			var officers = null;
			var officers2 = null;
		
			$(function() {
				$.getJSON('./data.json', function(data) {
					officers = data;
				});
				$.getJSON('./data2.json', function(data) {
					officers2 = data;
				});
			});
			
			function reset() {
				$('#result-table').find('tbody').empty();
				$('#no').val() = '';
			}
		
			function search() {
				var no = $('#no').val();
				
				if (!!no) {
					if (!officers.hasOwnProperty(no)) {
						search2();
					} else {
						var name = officers[no].name;
						var position = officers[no].position;
						var isAuxiliary = officers[no].isAuxiliary;
						
						var row = (
							'<tr>'
							+ '<td>' + no + '</td>'
							+ '<td>' + name + '</td>'
							+ '<td>' + position + '</td>'
							+ '<td>' + (isAuxiliary ? '<i class="material-icons">check</i>' : '<i class="material-icons">close</i>') + '</td>'
							+ '</tr>'
						);
						
						$('#result-table').find('tbody').prepend(row);
					}
				}
			}
			
			function search2() {
				var no = $('#no').val();
				
				if (!!no) {
					if (!officers2.hasOwnProperty(no)) {
						document.querySelector('#snackbar').MaterialSnackbar.showSnackbar({message: '找不到警員 (編號: ' + no + ')'});
					} else {
						var name = officers2[no][0];
						var role = officers2[no][1];
						var isAuxiliary = !!officers2[no][2];
						
						var row = (
							'<tr>'
							+ '<td>' + no + '</td>'
							+ '<td>' + name + '</td>'
							+ '<td>' + (
								role == 1 ? '警司' :
								role == 2 ? '總督察' :
								role == 3 ? '高級督察' :
								role == 4 ? '督察' :
								role == 5 ? '警署警長' :
								role == 6 ? '警長' :
								role == 7 ? '高級警員' :
								'警員'
								) + '</td>'
							+ '<td>' + (isAuxiliary ? '<i class="material-icons">check</i>' : '<i class="material-icons">close</i>') + '</td>'
							+ '</tr>'
						);
						
						$('#result-table').find('tbody').prepend(row);
					}
				}
			}
		</script>
	</body>
</html> 
